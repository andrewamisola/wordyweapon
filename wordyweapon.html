<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Wordy Weapon</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">

</head>
<body>
<div id="header">
  <div id="title" class="gold">‚öíÔ∏è WORDY WEAPON</div>
  <div id="stats">
    <!-- Wins and losses removed for a streamlined UI; only streak is shown -->
    <span>üî•<span id="streak" class="gold">0</span></span>
      <span>üí∞<span id="gold" class="gold">30</span></span>
    <!-- Removed level tracker for simplicity; the streak already communicates progress -->
    <span>Round <span id="round-num" class="gold">1</span></span>
  </div>
  <button id="pause-btn" style="font-size:12px;padding:6px 12px">Menu</button>
</div>

<div id="battle-view">
  <div class="portrait-container">
    <div class="portrait hero-portrait">
      <div class="portrait-frame"></div>
      <div class="portrait-info">
        <div class="portrait-name hero-c" id="hero-name">Hero</div>
        <!-- Element strengths/weaknesses and weapon proficiency will be inserted here -->
        <div class="portrait-elements" id="hero-elements"></div>
        <!-- Acquired talents displayed here -->
        <div class="hero-talents" id="hero-talents"></div>
        <!-- Random dialogue line displayed below the hero portrait for extra flavour -->
        <div class="portrait-dialogue" id="hero-inline-dialogue"></div>
        <div class="health-bar-container">
          <div class="health-bar hero-bar">
            <div class="health-fill hero-fill" id="hero-health-fill"></div>
            <div class="health-preview damage-preview" id="hero-damage-preview"></div>
          </div>
          <div class="health-text" id="hero-health-text">100 / 100</div>
        </div>
        <div class="portrait-details">
          <!-- Details toggle removed; details now show on hover -->
        </div>
      </div>
    </div>
  </div>

  <div id="vs-center">
    <div id="weapon-display">
      <svg id="weapon-svg" viewBox="0 0 100 130"></svg>
      <div id="weapon-name"></div>
    </div>
    <div id="damage-preview-text">
      <div class="damage-number hero-damage" id="preview-hero-dmg">0</div>
      <!-- Final damage (AP) will be displayed below the calculation -->
      <div class="ap-number" id="preview-base-ap">0</div>
    </div>
  </div>

  <div class="portrait-container">
    <div class="portrait enemy-portrait">
      <div class="portrait-frame"></div>
      <div class="portrait-info">
        <div class="portrait-name enemy-c" id="enemy-name">Enemy</div>
        <!-- Enemy elemental weaknesses/resistances will be inserted here -->
        <div class="portrait-elements" id="enemy-elements"></div>
        <!-- Random dialogue line displayed below the enemy portrait -->
        <div class="portrait-dialogue" id="enemy-inline-dialogue"></div>
        <div class="health-bar-container">
          <div class="health-bar enemy-bar">
            <div class="health-fill enemy-fill" id="enemy-health-fill"></div>
            <div class="health-preview damage-preview" id="enemy-damage-preview"></div>
          </div>
          <div class="health-text" id="enemy-health-text">100 / 100</div>
        </div>
        <div class="portrait-details">
          <!-- Details toggle removed; details now show on hover -->
        </div>
      </div>
    </div>
  </div>
</div>

<div class="details-panel hidden" id="hero-details-panel">
  <div class="details-content">
    <div class="card-desc" id="hero-desc">A brave warrior.</div>
    <div class="card-dialogue" id="hero-dialogue">"Greetings, Wordsmith."</div>
    <!-- Hero Base AP removed from portrait; it will be shown in the preview area -->
    <div class="card-section"><div class="card-section-title">Strong using</div><div id="hero-str"></div></div>
    <div class="card-section"><div class="card-section-title">Weak using</div><div id="hero-weak"></div></div>
    <div class="card-section"><div class="card-section-title">PROFICIENCIES</div><div id="hero-prof"></div></div>
  </div>
</div>

<div class="details-panel hidden" id="enemy-details-panel">
  <div class="details-content">
    <div class="card-desc" id="enemy-desc">A fearsome foe.</div>
    <div class="card-dialogue" id="enemy-dialogue">"You dare challenge me?"</div>
    <div class="card-section"><div class="card-section-title">Weak against</div><div id="enemy-weak"></div></div>
    <div class="card-section"><div class="card-section-title">Strong against</div><div id="enemy-res"></div></div>
  </div>
</div>

<div id="forge">
  <!-- Updated title emphasises the combat objective -->
  <div id="forge-title" class="gold">‚öíÔ∏è Forge a "wordy" weapon to defeat the enemy</div>
  <div id="sentence">
    <div class="slot-container hidden" data-slot="adj1">
      <!-- Show a hint for the type of word expected in this slot -->
      <div class="slot" data-slot="adj1">Adjective</div>
      <div class="slot-calc" id="calc-adj1"></div>
    </div>
    <div class="slot-container hidden" data-slot="adj2">
      <div class="slot" data-slot="adj2">Adjective</div>
      <div class="slot-calc" id="calc-adj2"></div>
    </div>
    <div class="slot-container" data-slot="item">
      <div class="slot" data-slot="item">Weapon</div>
      <div class="slot-calc" id="calc-item"></div>
    </div>
    <div id="of-label" class="hidden">of the</div>
    <div class="slot-container hidden" data-slot="adj3">
      <div class="slot" data-slot="adj3">Adjective</div>
      <div class="slot-calc" id="calc-adj3"></div>
    </div>
    <div class="slot-container hidden" data-slot="adj4">
      <div class="slot" data-slot="adj4">Adjective</div>
      <div class="slot-calc" id="calc-adj4"></div>
    </div>
    <div class="slot-container hidden" data-slot="noun1">
      <div class="slot" data-slot="noun1">Gem (2x AP)</div>
      <div class="slot-calc" id="calc-noun1"></div>
    </div>
    <!-- Removed second gem (noun2) slot to enforce only one gem slot -->
  </div>

  <!-- Talent bar displays active run modifiers.  Talents are not interactive but
       their effects apply automatically during damage calculation.  Up to 5
       talents may be held at once. -->
  <div id="talent-bar" style="display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin:6px 0"></div>
  <div id="backup-weapon">‚ö†Ô∏è No weapons! Using backup Stick (√ó0.5 damage)</div>
  <div id="bank-controls">
    <div id="bank-hint">üìú Click words to fill slots ‚Ä¢ Click slots to remove</div>
    <!-- Display current inventory count versus limit -->
    <div id="inv-counter" style="font-size:11px;color:#6b7280">0/0</div>
    <div id="sort-btns">
      <button data-sort="type" class="active">Type</button>
      <button data-sort="alpha">A-Z</button>
      <button data-sort="rarity">Rarity</button>
      <!-- Toggle sort direction for the forge inventory (ascending vs descending) -->
      <button id="sort-dir-btn-forge" style="padding:4px 10px;font-size:10px">‚Üì</button>
    </div>
  </div>
  <div id="bank"></div>
  <!-- Display available consumables during forging -->
  <div id="consumables-bar"></div>
  <div id="buttons">
    <button id="forge-btn" disabled>‚öîÔ∏è FORGE WEAPON</button>
  </div>
</div>

<div class="overlay" id="combat-overlay">
  <div class="modal" style="min-width:500px">
    <div id="combat-container">
      <div id="combat-flames"></div>
      <div id="combat-weapon-container">
        <svg id="combat-weapon-svg" viewBox="0 0 100 130"></svg>
      </div>
      <div id="combat-words"></div>
      <div id="combat-total" class="gold"></div>
    </div>
    <div id="combat-dmg">
      <div class="combat-block"><div class="combat-label">HERO STRIKES</div><div class="combat-value hero-c" id="cb-hero">0</div></div>
      <div style="font-size:24px" class="dim">‚öî</div>
      <div class="combat-block"><div class="combat-label">ENEMY STRIKES</div><div class="combat-value enemy-c" id="cb-enemy">0</div></div>
    </div>
    <div id="combat-bars">
      <div class="bar-block"><div class="bar-label">Hero HP</div><div class="bar-outer"><div class="bar-inner hero" id="bar-hero"></div></div><div class="bar-text hero-c" id="txt-hero">100/100</div></div>
      <div class="bar-block"><div class="bar-label">Enemy HP</div><div class="bar-outer"><div class="bar-inner enemy" id="bar-enemy"></div></div><div class="bar-text enemy-c" id="txt-enemy">100/100</div></div>
    </div>
    <div id="combat-result"><div id="combat-result-title"></div><div id="combat-result-detail"></div></div>
    <div class="modal-buttons">
      <button id="combat-continue">Continue</button>
    </div>
  </div>
</div>

<div class="overlay" id="shop-overlay">
  <div class="modal" style="min-width:600px">
    <div class="modal-title gold">üõí SHOP <span id="shop-gold"></span></div>

    <!-- Inventory display moved inline with the inventory section header -->

    <!-- Hero and Enemy Info Side-by-Side -->
    <div style="display:flex;gap:12px;margin-bottom:12px">
      <!-- Current Hero info -->
      <div class="shop-section" style="flex:1;background:#1a1a1a;padding:12px;border-radius:8px">
        <div class="shop-section-title" style="margin-bottom:8px">HERO INFO</div>
        <div id="shop-hero-info" style="font-size:11px;color:#d1d5db;line-height:1.4"></div>
      </div>
      <!-- Next Enemy Preview -->
      <div class="shop-section" style="flex:1;background:#1a1a1a;padding:12px;border-radius:8px">
        <div class="shop-section-title" style="margin-bottom:8px">‚ö†Ô∏è NEXT ENEMY</div>
        <div id="next-enemy-preview" style="font-size:11px;color:#d1d5db;line-height:1.4"></div>
      </div>
    </div>

    <!-- Crates and Buffs Side-by-Side -->
    <div style="display:flex;gap:12px;margin-bottom:12px">
      <div class="shop-section" style="flex:1">
        <div class="shop-section-title">üì¶ WORD CRATES</div>
        <div id="shop-crates" style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap"></div>
      </div>
      <div class="shop-section" style="flex:1; display:none">
        <div class="shop-section-title">‚ú® BUFFS</div>
        <div id="shop-buff-crates" style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap"></div>
      </div>
    </div>
    <div class="shop-section">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px">
        <div class="shop-section-title" style="margin:0">üé¥ CONSUMABLES</div>
        <div id="shop-consumable-cap" class="dim" style="font-size:11px"></div>
      </div>
      <div id="shop-consumables" style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap"></div>
    </div>
    <!-- Word Bank for selling -->
    <div class="shop-section">
      <!-- Inventory header row includes title, capacity tracker, and sort controls -->
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
        <div style="display:flex;align-items:center;gap:8px">
          <div class="shop-section-title" style="margin:0">üìú YOUR INVENTORY</div>
          <!-- Live inventory capacity is updated via renderShopWordBank() -->
          <div id="shop-inventory" style="font-size:11px;color:#9ca3af"></div>
        </div>
        <div id="shop-sort-btns" style="display:flex;gap:4px;align-items:center">
          <button data-sort="type" class="active" style="padding:4px 10px;font-size:10px">Type</button>
          <button data-sort="alpha" style="padding:4px 10px;font-size:10px">A-Z</button>
          <button data-sort="rarity" style="padding:4px 10px;font-size:10px">Rarity</button>
          <button id="sort-dir-btn" style="padding:4px 10px;font-size:10px">‚Üì</button>
        </div>
      </div>
      <div id="shop-word-bank" style="display:flex;flex-wrap:wrap;gap:6px;justify-content:center;min-height:60px;padding:8px;background:#0d1017;border-radius:8px"></div>
      <div style="text-align:center;margin-top:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px">
        <div id="sell-price-display" style="font-size:14px;color:#fbbf24;font-weight:bold;min-width:80px"></div>
        <button id="sell-word-btn" disabled style="padding:6px 16px">üí∞ Sell Selected</button>
        <button id="deselect-btn" style="padding:4px 12px">Deselect</button>
      </div>
    </div>

    <!-- Active Buffs section disabled while buffs are removed from the game -->
    <div class="shop-section" style="margin-top:12px; display:none">
      <div id="shop-talent-bar"></div>
    </div>

    <div id="shop-reroll"><button id="reroll-btn">üé≤ Reroll (<span id="reroll-cost">5</span>üí∞)</button></div>

    <div class="modal-buttons" style="display:flex;justify-content:center;gap:8px">
      <button id="shop-menu">Menu</button>
      <button id="shop-continue">Continue</button>
    </div>
  </div>
</div>

<!-- Inventory overlay removed -->

<div class="overlay" id="hero-select-overlay">
  <div class="modal" style="min-width:700px;max-width:900px">
    <div class="modal-title gold">‚öíÔ∏è SELECT YOUR HERO</div>
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px">
      <button id="hero-prev" style="font-size:24px;padding:8px 16px">‚óÄ</button>
      <div id="hero-carousel" style="flex:1;overflow:hidden">
        <div id="hero-card-container" style="display:flex;transition:transform 0.3s ease"></div>
      </div>
      <button id="hero-next" style="font-size:24px;padding:8px 16px">‚ñ∂</button>
    </div>
    <div style="text-align:center">
      <button id="hero-select-btn" style="padding:12px 32px;font-size:16px;background:linear-gradient(180deg,#3d5a37,#2d4a27);border-color:#4ade8055">SELECT HERO</button>
    </div>
  </div>
</div>

<div class="overlay" id="talent-overlay">
  <div class="modal" style="min-width:500px">
    <div class="modal-title gold">üåü LEVEL UP! Choose a Talent</div>
    <div style="text-align:center;margin-bottom:16px;font-size:14px">
      Level <span id="talent-level" class="gold">2</span>
    </div>
    <div id="talent-choices" style="display:flex;flex-direction:column;gap:10px"></div>
  </div>
</div>

<div class="overlay" id="buff-select-overlay">
  <div class="modal" style="min-width:500px">
    <div class="modal-title" style="color:#a855f7">‚ú® Choose a Buff</div>
    <div style="text-align:center;margin-bottom:16px;font-size:13px;color:#9ca3af">
      Select 1 of 3 buffs to add to your run
    </div>
    <div id="buff-choices" style="display:flex;flex-direction:column;gap:10px"></div>
  </div>
</div>

<button id="audio-toggle">üîä Sound: ON</button>

<!-- Main menu overlay displayed on initial load.  Provides a simple title screen with a start button.  -->
<div class="overlay show" id="main-menu">
  <div class="modal" style="text-align:center;min-width:400px">
    <div style="font-size:32px;font-weight:bold;margin-bottom:10px" class="gold">WORDY WEAPON</div>
    <div style="font-size:14px;color:#9ca3af;margin-bottom:20px">Forge a "wordy" weapon to defeat the enemy</div>
    <div style="display:flex;flex-direction:column;gap:8px;align-items:center">
      <button id="continue-btn" style="padding:10px 30px;font-size:16px;border-radius:8px;background:#1f2937;border:1px solid #4ade8055;display:none">Continue Run</button>
      <button id="start-game-btn" style="padding:10px 30px;font-size:16px;background:linear-gradient(180deg,#3d5a37,#2d4a27);border:1px solid #4ade8055;border-radius:8px;cursor:pointer">Start New Run</button>
      <button id="achievements-btn" style="padding:10px 30px;font-size:14px;border-radius:8px;background:#111827;border:1px solid #374151">Achievements & Stats</button>
      <button id="exit-btn" style="padding:8px 26px;font-size:14px;border-radius:8px;background:#0f172a;border:1px solid #374151">Exit Menu</button>
    </div>
  </div>
</div>

<!-- Pause / Menu overlay accessible during runs -->
<div class="overlay" id="pause-menu">
  <div class="modal" style="text-align:center;min-width:360px">
    <div style="font-size:22px;font-weight:bold;margin-bottom:10px" class="gold">Wordy Weapon</div>
    <div style="display:flex;flex-direction:column;gap:8px;align-items:center">
      <button id="pause-continue" style="padding:8px 24px;border-radius:8px;background:#1f2937;border:1px solid #4ade8055">Continue Run</button>
      <button id="pause-new" style="padding:8px 24px;border-radius:8px;background:#2d4a27;border:1px solid #4ade8055">Start New Run</button>
      <button id="pause-achievements" style="padding:8px 24px;border-radius:8px;background:#111827;border:1px solid #374151">Achievements & Stats</button>
      <button id="pause-exit" style="padding:8px 24px;border-radius:8px;background:#0f172a;border:1px solid #374151">Close Menu</button>
    </div>
  </div>
</div>

<!-- Achievements overlay shows persistent progress -->
<div class="overlay" id="achievements-overlay">
  <div class="modal" style="min-width:420px">
    <div class="modal-title gold" style="text-align:center">üìú Achievements & Stats</div>
    <div id="stats-container" style="font-size:12px;color:#d1d5db;line-height:1.5"></div>
    <div style="text-align:center;margin-top:12px;display:flex;justify-content:center;gap:8px">
      <button id="stats-reset">Reset Data</button>
      <button id="achievements-close">Close</button>
    </div>
  </div>
</div>

<script src="script.js"></script>

</body>
</html>
